import{b as y,j as t,c as m,r as b,P as ce,C as G,u as oe,A as de,a as ue,L as xe,d as me}from"./index-ctt-mXTq.js";import{B as L}from"./button-Dkpu1_Si.js";import{c as fe,T as pe,a as ge,b as he}from"./reportUtils-DQsbpbty.js";import{i as F}from"./dataUtils-t-YWtWD_.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],be=y("chevron-left",ve);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],V=y("chevron-right",ye);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]],Ne=y("circle-dot",je);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"m21 3-6.75 6.75",key:"pv0uzu"}],["circle",{cx:"10",cy:"14",r:"6",key:"1qwbdc"}]],Ie=y("mars",ke);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],we=y("star",Ce);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M9 19h6",key:"456am0"}],["circle",{cx:"12",cy:"9",r:"6",key:"1nw4tq"}]],Ae=y("venus",Se);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],H=y("x",ze);function M({className:i,type:o,...c}){return t.jsx("input",{type:o,"data-slot":"input",className:m("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-border flex h-9 w-full min-w-0 rounded-sm border bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:bg-accent-foreground focus-visible:text-slate-900","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),...c})}var Te="Label",J=b.forwardRef((i,o)=>t.jsx(ce.label,{...i,ref:o,onMouseDown:c=>{var f;c.target.closest("button, input, select, textarea")||((f=i.onMouseDown)==null||f.call(i,c),!c.defaultPrevented&&c.detail>1&&c.preventDefault())}}));J.displayName=Te;var _e=J;function qe({className:i,...o}){return t.jsx(_e,{"data-slot":"label",className:m("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",i),...o})}const Le={yes:t.jsx(G,{className:"size-6 shrink-0"}),no:t.jsx(H,{className:"size-6 shrink-0"}),male:t.jsx(Ie,{className:"size-6 shrink-0"}),female:t.jsx(Ae,{className:"size-6 shrink-0"}),default:t.jsx(Ne,{className:"size-6 shrink-0"}),none:t.jsx(t.Fragment,{})},X=({onClick:i,icon:o="",children:c,className:w,selected:f,disabled:x})=>t.jsxs("div",{onClick:x?void 0:i,className:m("text-primary-foreground flex w-full cursor-pointer items-center gap-3 rounded border p-2 text-xs transition-colors md:text-sm",f?"border-primary-ring bg-primary-ring/50":"border-input bg-input hover:bg-input/50",x&&"cursor-not-allowed opacity-50",w),tabIndex:x?-1:0,role:"button","aria-pressed":f,children:[o&&Le[o],t.jsx("span",{className:"flex-1",children:c})]}),Y=[{value:1,label:"To a very small degree"},{value:2,label:"To a small degree"},{value:3,label:"To a lesser extent"},{value:4,label:"Partially"},{value:5,label:"To some extent"},{value:6,label:"To a large extent"},{value:7,label:"To a very large extent"}];function Ee(){const i=oe(),o=b.useContext(de),{domains:c,skills:w}=ue(),{assessmentId:f,questions:x,answers:d,currentQuestionId:K,currentQuestionIndex:u,onQuestionChange:R,onAnswer:p,isLoading:U,isCompleted:W}=o,s=x[u],k=x.length,[Z,P]=b.useState(""),[z,$]=b.useState(0),[I,T]=b.useState(""),[C,E]=b.useState([]),[_,Q]=b.useState(""),j=(e,r=!0)=>{var l;if(!s)return!1;switch(s.type){case"static":return!0;case"multi-select":{if(!Array.isArray(e))return!1;if(!r)return e.length>0;const a=typeof s.required=="object"?s.required.min||1:s.required?1:0,n=typeof s.required=="object"?s.required.max||1/0:s.required?1/0:0;return e.length>=a&&e.length<=n}case"select":if(typeof e=="object"&&e&&"value"in e){const{value:a,extra:n}=e,g=(l=s.options)==null?void 0:l.find(S=>S.value===a);if(g!=null&&g.extraInput&&r){if(g.extraInput.type==="email")return!!n&&F(n);if(g.extraInput.required)return!!n&&n!==""}return!!a}return typeof e=="string"&&e!=="";default:return typeof s.required=="boolean"&&!s.required?!0:e!=null&&e!==""&&e!==0}};b.useEffect(()=>{if(!s)return;const e=d[s.id];switch(s.type){case"rating":$(typeof e=="number"?e:0);break;case"select":typeof e=="object"&&e&&"extra"in e?(T(e.value),Q(e.extra||"")):T(typeof e=="string"?e:"");break;case"multi-select":E(Array.isArray(e)?e:[]);break;case"text":P(typeof e=="string"?e:"");break}},[K,s,d]);const ee=e=>{$(e),p(s.id,e)},te=e=>{var r;if(I!==e){T(e);const l=(r=s.options)==null?void 0:r.find(a=>a.value===e);l!=null&&l.extraInput?p(s.id,{value:e,extra:_||""}):p(s.id,e)}},se=e=>{const r=C.includes(e)?C.filter(l=>l!==e):[...C,e];E(r),p(s.id,r)},ae=e=>{P(e),p(s.id,e)},D=e=>{Q(e),p(s.id,{value:I,extra:e})},O=()=>{u<k-1&&R(x[u+1].id)},re=()=>{u>0&&R(x[u-1].id)},le=async()=>{const e=x.filter(l=>l.type=="rating"),r=fe(e,d,w,c);await me(f,r),i(`/report/${f}`)},ne=e=>{var r,l;switch(e.type){case"rating":return t.jsx("div",{className:"my-4",children:t.jsx("div",{className:"grid h-20 grid-cols-7 items-center justify-items-center gap-2 lg:gap-8",children:Y.map(a=>t.jsxs(pe,{children:[t.jsx(ge,{children:t.jsx(we,{onClick:()=>ee(a.value),className:m("hover:text-secondary-ring hover:fill-secondary-ring size-6 cursor-pointer lg:size-12",a.value===z||a.value<(z??0)?"fill-primary-ring text-primary-ring":"fill-muted text-muted",a.value===z?"scale-125":"")})}),t.jsx(he,{children:a.label})]},a.value))})});case"select":return t.jsx("div",{className:m("my-4 w-full",s.options.length>7?"grid grid-cols-2 gap-2 md:grid-cols-4":"flex flex-col gap-2 lg:w-3/4"),children:(r=e.options)==null?void 0:r.map(a=>t.jsxs(X,{className:s.options.length>7?"h-24 text-center":"h-auto text-left",selected:I===a.value,icon:a.icon,onClick:()=>{I!==a.value&&te(a.value)},children:[a.label,a.extraInput&&t.jsx(M,{className:"placeholder:text-accent bg-accent-foreground border-accent-foreground text-accent mt-2",type:a.extraInput.type,placeholder:a.extraInput.placeholder,value:_,onChange:n=>D(n.target.value),required:a.extraInput.required,disabled:I!==a.value})]},a.value))});case"multi-select":return t.jsx("div",{className:m("my-4 w-full",s.options.length>7?"grid grid-cols-2 gap-2 md:grid-cols-4":"flex flex-col gap-2 lg:w-3/4"),children:(l=e.options)==null?void 0:l.map(a=>t.jsxs(X,{className:s.options.length>7?"h-24 text-center":"h-auto text-left",selected:C.includes(a.value),icon:a.icon,onClick:()=>se(a.value),children:[a.label,a.extraInput&&t.jsx(M,{className:"placeholder:text-accent bg-accent-foreground border-accent-foreground text-accent mt-2",type:a.extraInput.type,placeholder:a.extraInput.placeholder,value:_,onClick:n=>n.stopPropagation(),onChange:n=>D(n.target.value),required:a.extraInput.required,disabled:!C.includes(a.value)})]},a.value))});case"text":return t.jsxs("div",{className:"my-4 w-full space-y-2 lg:w-3/4",children:[t.jsx(qe,{htmlFor:"text-input",children:s.title}),t.jsx(M,{id:"text-input",type:"text",className:"bg-accent-foreground text-accent w-full",value:Z,onChange:a=>ae(a.target.value)})]});case"static":default:return null}},ie=(e,r)=>{var l,a,n,g,S,B;if(e.type==="static")return"I have read and understood the instructions.";if(!r)return"";switch(e.type){case"rating":return typeof r=="number"&&((l=Y[r-1])==null?void 0:l.label)||r.toString();case"select":if(typeof r=="object"&&r!==null&&"value"in r){const{value:h,extra:v}=r,A=((n=(a=e.options)==null?void 0:a.find(q=>q.value===h))==null?void 0:n.label)||h,N=(g=s.options)==null?void 0:g.find(q=>q.value===h);return N!=null&&N.extraInput&&N.extraInput.type==="email"?v&&F(v)?v:"Invalid email":v||A}return typeof r=="string"?((B=(S=e.options)==null?void 0:S.find(h=>h.value===r))==null?void 0:B.label)||r:"";case"multi-select":return Array.isArray(r)?r.map(h=>{var v,A;return((A=(v=e.options)==null?void 0:v.find(N=>N.value===h))==null?void 0:A.label)||h}).join(", "):"";case"text":return typeof r=="string"?r:r.toString();default:return""}};return U||!s?t.jsx(xe,{message:"Preparing Assessment..."}):t.jsx("div",{className:"w-full overflow-x-hidden",children:t.jsxs("div",{className:"mx-auto flex min-h-screen max-w-7xl flex-col px-4 py-6 text-center sm:px-6",children:[t.jsxs("div",{className:"flex grow flex-col",children:[t.jsx("h1",{className:"border-border bg-input rounded-sm border py-2 text-2xl",children:s.title}),t.jsxs("div",{className:"flex w-fit flex-1 flex-col items-center justify-center self-center md:w-2xl",children:[t.jsxs("div",{className:"my-4 space-y-2",children:[t.jsx("p",{className:"text-muted-foreground text-lg",children:s.statement}),t.jsx("p",{className:m("text-accent-foreground leading-relaxed whitespace-pre-wrap"),children:s.description})]}),ne(s),t.jsx("div",{className:m("my-4 flex min-h-10 w-full justify-center rounded-sm px-4 py-2",j(d[s.id],!1)?"bg-input":""),children:j(d[s.id],!1)&&t.jsxs("div",{className:m("flex items-center justify-center gap-2 text-sm font-semibold md:text-base",j(d[s.id])?"text-success":"text-destructive"),children:[j(d[s.id])?t.jsx(G,{className:"size-6 shrink-0"}):t.jsx(H,{className:"size-6 shrink-0"}),t.jsx("span",{className:"line-clamp-2",children:ie(s,d[s.id])})]})}),t.jsx("div",{className:"mt-4",children:W?t.jsx("div",{className:"text-muted-foreground text-sm",children:"Assessment completed. You can only review your answers now."}):t.jsxs(L,{onClick:()=>{s.type==="static"?p(s.id,"acknowledged"):p(s.id,d[s.id]),u===k-1?le():O()},disabled:!j(d[s.id]),className:"hover:bg-blue-700 md:order-3",children:[u===k-1?"Complete":"Confirm and Continue",t.jsx(V,{className:"size-4"})]})})]})]}),t.jsx("footer",{className:"border-border mt-8 border-t p-4",children:t.jsxs("div",{className:"mx-auto flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("div",{className:"w-full text-center md:order-2 md:w-auto",children:[t.jsxs("div",{className:"text-muted-foreground text-sm",children:["Question ",u+1," of ",k]}),t.jsx("div",{className:"text-muted text-xs",children:s.domain})]}),t.jsxs(L,{onClick:re,disabled:u===0,className:"bg-ring hover:bg-muted md:order-1",children:[t.jsx(be,{className:"size-4"}),"Previous"]}),t.jsxs(L,{onClick:O,disabled:!j||u===k-1,className:"hover:bg-blue-700 md:order-3",children:["Next",t.jsx(V,{className:"size-4"})]})]})})]})})}export{Ee as default};
